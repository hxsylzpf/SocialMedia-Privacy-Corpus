{
  "lead": "App developers given access to Apple's private APIs as fix for hack that allows people to make fake in-app purchases. By Charles Arthur",
  "id": "technology/2012/jul/23/apple-ios-hack-developers-fix",
  "class": null,
  "title": "Apple offers fix for in-app purchase hack, but users can avoid it",
  "core-words": {
    "fake": 2,
    "site": 2,
    "spoof": 1,
    "inside": 1,
    "api": 2,
    "place": 1,
    "user": 4,
    "correct": 1,
    "app": 16,
    "contact": 1,
    "separately": 1,
    "simple": 1,
    "symbol": 1,
    "money": 1,
    "notify": 1,
    "figure": 1,
    "pass": 1,
    "viewpoint": 1,
    "way": 1,
    "affect": 1,
    "validate": 3,
    "hack": 4,
    "old": 1,
    "upgrade": 1,
    "show": 1,
    "connect": 1,
    "roll": 1,
    "implement": 2,
    "level": 1,
    "public": 2,
    "effectively": 1,
    "receive": 2,
    "people": 1,
    "private": 2,
    "increasingly": 1,
    "fail": 1,
    "faked": 1,
    "blog": 1,
    "return": 1,
    "avoid": 1,
    "act": 1,
    "use": 3,
    "fortnight": 2,
    "itunes": 1,
    "game": 2,
    "indicate": 1,
    "store": 1,
    "ssl": 1,
    "build": 1,
    "check": 4,
    "important": 1,
    "develop": 1,
    "proxy": 1,
    "capability": 1,
    "system": 2,
    "certificate": 3,
    "meaning": 1,
    "server": 10,
    "begin": 1,
    "say": 3,
    "website": 1,
    "entire": 1,
    "download": 1,
    "allow": 1,
    "offer": 2,
    "code": 1,
    "access": 1,
    "secure": 1,
    "valid": 2,
    "new": 2,
    "let": 3,
    "developer": 8,
    "purchase": 12,
    "architecture": 1,
    "perform": 1,
    "version": 1,
    "ago": 2,
    "wipe": 1,
    "device": 1,
    "respond": 1,
    "list": 1,
    "page": 1,
    "free": 1,
    "hacker": 1,
    "fix": 5,
    "take": 1,
    "pretend": 1,
    "datum": 1,
    "give": 1,
    "method": 1,
    "workaround": 1,
    "confirm": 2,
    "send": 1,
    "transaction": 3,
    "receipt": 3,
    "pay": 1,
    "carry": 1,
    "appstore": 1
  },
  "words": {
    "reaction": 1,
    "fake": 3,
    "operate": 1,
    "site": 3,
    "spoof": 1,
    "level": 1,
    "api": 4,
    "magazine": 1,
    "unique": 1,
    "place": 2,
    "user": 5,
    "correct": 1,
    "wait": 1,
    "somewhat": 1,
    "app": 18,
    "purpose": 1,
    "separately": 1,
    "simple": 1,
    "try": 1,
    "mistake": 1,
    "symbol": 1,
    "money": 1,
    "notify": 1,
    "secure": 1,
    "figure": 2,
    "pass": 1,
    "viewpoint": 1,
    "valid": 2,
    "take": 1,
    "flaw": 1,
    "validate": 3,
    "hack": 9,
    "ios": 2,
    "old": 1,
    "build": 1,
    "show": 1,
    "similar": 1,
    "include": 1,
    "connect": 2,
    "roll": 1,
    "implement": 2,
    "important": 1,
    "public": 2,
    "probably": 1,
    "bypass": 1,
    "effectively": 1,
    "result": 1,
    "note": 1,
    "block": 1,
    "version": 1,
    "update": 2,
    "return": 2,
    "private": 3,
    "increasingly": 1,
    "fail": 1,
    "datum": 1,
    "certificate": 4,
    "post": 2,
    "look": 1,
    "faked": 2,
    "blog": 1,
    "add": 1,
    "revise": 1,
    "avoid": 1,
    "service": 1,
    "act": 2,
    "documentation": 1,
    "validity": 1,
    "comic": 1,
    "inside": 1,
    "hd": 1,
    "suggest": 2,
    "card": 1,
    "fortnight": 2,
    "way": 2,
    "itunes": 2,
    "offer": 3,
    "dissuade": 1,
    "indicate": 1,
    "store": 3,
    "fraudulently": 1,
    "run": 1,
    "million": 1,
    "ssl": 1,
    "attempt": 1,
    "check": 5,
    "game": 4,
    "develop": 1,
    "specific": 1,
    "proxy": 1,
    "capability": 1,
    "open": 1,
    "system": 4,
    "work": 2,
    "fall": 1,
    "contact": 1,
    "meaning": 1,
    "server": 11,
    "angry": 1,
    "website": 1,
    "use": 4,
    "begin": 1,
    "company": 1,
    "say": 7,
    "vulnerability": 1,
    "autumn": 1,
    "download": 2,
    "seriousness": 1,
    "allow": 2,
    "birds": 1,
    "hand": 1,
    "process": 1,
    "apps": 2,
    "developer": 12,
    "startup": 1,
    "access": 3,
    "receive": 2,
    "upgrade": 2,
    "code": 1,
    "new": 2,
    "let": 4,
    "people": 1,
    "purchase": 13,
    "architecture": 1,
    "perform": 1,
    "obscure": 1,
    "transaction": 4,
    "expect": 1,
    "wipe": 1,
    "device": 1,
    "respond": 1,
    "ios6": 1,
    "list": 1,
    "good": 1,
    "release": 1,
    "free": 1,
    "hacker": 1,
    "entire": 1,
    "fix": 7,
    "currently": 1,
    "affect": 2,
    "send": 1,
    "pretend": 1,
    "victim": 1,
    "irrevocably": 1,
    "reuse": 1,
    "carry": 1,
    "method": 1,
    "workaround": 1,
    "confirm": 2,
    "demonstrate": 1,
    "time": 1,
    "page": 1,
    "ago": 2,
    "receipt": 5,
    "pay": 1,
    "content": 1,
    "give": 3,
    "desktop": 1,
    "appstore": 1
  },
  "tags": [
    "technology/apps",
    "technology/apple",
    "technology/hacking",
    "technology/technology",
    "technology/software",
    "technology/internet",
    "technology/iphone",
    "technology/programming"
  ],
  "content": "Apple has notified app developers of a fix for a Russian hacker's method that let him make more than 8.4m fake in-app purchases and pass them on to users. The fix gives developers access to two of Apple's private APIs on iOS, a move the company has not made before and which demonstrates the seriousness of the flaw. At least 115 games were affected, including Tap Tap Revenge 4, Temple Run, Plants vs Zombies HD, Infinity Blade 1 and 2, Fruit Ninja, Fifa 2012 and Angry Birds. The fix will check whether both new and old purchases are valid \u2013 meaning that once it is implemented in an app, faked purchases will effectively be wiped off on the devices of users who used the system developed by Alexey Borodin, and which he made public a fortnight ago. That could, however, dissuade those who have already used the fake system from upgrading their apps. Apple says that the hack will be irrevocably fixed in iOS6. Meanwhile, it is trying to block attempts by Borodin to connect to its servers to make further faked purchases. In-app purchases have become an increasingly important way for developers to make money from apps, by letting users download a simple version for free and then offering paid-for levels, upgrades or capabilities inside the game. Borodin, who figured out how to hack the system for in-app purchases by spoofing the receipt from Apple's servers, says on his blog that once developers implement and roll out the fix, \"[the] game is over. Currently we have no way to bypass updated APIs.\" But he adds that he will keep offering the service until the next version of iOS is released, expected some time in the autumn. Next he says that he will look to see if the App Store on Apple's Mac OSX desktop operating system has a similar vulnerability. \"We are still waiting for Apple's reaction and we have some cards in the hand,\" Borodin notes. \"It's good that OS X is open.\" Borodin's hack will probably keep working on apps until they are updated, and users download the revised apps. After posting that the game is over, on Monday he posted a further hack suggesting that he has now figured out how to get content from Apple's Newsstand, giving access to magazines and comics. His workaround uses his own In-Appstore website to act as a proxy server that pretends, from the app's viewpoint, to be Apple's servers which validates in-app purchases. In the app, such purchases check that an SSL certificate has been received, to indicate that a secure transaction has taken place \u2013 but Apple failed to build in checks to let apps confirm that the transaction was made with Apple's servers, rather than any site returning the correct code and a certificate. In a new page on the iOS developer site, Apple says that developers can re-validate transactions that have already been carried out by checking them against Apple's SSL certificate for its own server, using two private APIs: This listing uses the symbols kSecTrustInfoExtendedValidationKey and SecTrustCopyInfo, which are not public API. Your app is allowed to use them for this specific purpose. Developers who use their own servers for validating in-app purchases, which then connect to Apple's servers, will not have been affected by the hack, which Borodin began showing off around a fortnight ago. However Tony Million, an iOS developer running Zummer, a startup, suggested that developers should never have fallen victim to the hack. \"Apple has an entire server architecture for developers to confirm the receipt they've received from the in-app purchase was valid and made via the iTunes store,\" he said. \"Once you have performed the in-app purchase, you contact Apple's servers separately, send them the receipt data, and they [Apple's servers] respond with a YES or NO. You then act on this result. The second part of this [process] is to store the receipt so it can't be reused fraudulently \u2013 every receipt from the iTunes store is unique.\" Million said that while the documentation was somewhat obscure, it is on Apple's site. But Apple made a mistake in not letting developers check the validity of the SSL certificate returned from the transaction. \"That's why the hack works in the first place,\" he said."
}