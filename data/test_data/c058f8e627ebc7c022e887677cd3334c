{
  "lead": "Matthew Baxter-Reynolds: The announcement that Apple will introduce 'sandboxing' for code on Macs, and that Microsoft has similar plans for some Windows 8 apps, doesn't mean the malware problem is going to end",
  "id": "technology/blog/2011/nov/08/sandboxing-malware-failure",
  "words": {
    "steal": 2,
    "related": 1,
    "mean": 6,
    "code": 12,
    "spear": 1,
    "functionality": 2,
    "announcement": 1,
    "damage": 1,
    "menace": 2,
    "bit": 1,
    "society": 2,
    "care": 1,
    "lock": 2,
    "jump": 1,
    "file": 3,
    "bust": 1,
    "online": 1,
    "exist": 1,
    "curat": 2,
    "photo": 2,
    "implement": 1,
    "matter": 1,
    "regard": 2,
    "craft": 1,
    "request": 1,
    "absolutely": 2,
    "battle": 2,
    "think": 2,
    "magical": 1,
    "trivial": 1,
    "computer": 5,
    "look": 9,
    "affect": 1,
    "installation": 2,
    "proudly": 1,
    "choose": 1,
    "feeling": 1,
    "innovate": 1,
    "arbitrary": 1,
    "sandbox": 12,
    "place": 1,
    "principle": 1,
    "discuss": 1,
    "boot": 1,
    "simply": 4,
    "technique": 1,
    "act": 2,
    "typically": 2,
    "loss": 1,
    "publish": 1,
    "x/ios": 1,
    "arbitrarily": 1,
    "criminality": 1,
    "idea": 1,
    "wild": 1,
    "fireball": 1,
    "understanding": 1,
    "intend": 1,
    "innocent": 1,
    "test": 1,
    "provide": 1,
    "strength": 1,
    "acceptable": 1,
    "iphone": 1,
    "traceability": 1,
    "common": 2,
    "good": 4,
    "message": 1,
    "legislate": 1,
    "experience": 1,
    "vetting": 1,
    "access": 1,
    "stop": 2,
    "case": 3,
    "address": 1,
    "wrong": 4,
    "let": 1,
    "people": 4,
    "benign": 1,
    "mac": 2,
    "come": 1,
    "reason": 1,
    "intent": 2,
    "ability": 1,
    "near": 1,
    "usually": 2,
    "minority": 1,
    "explicitly": 3,
    "sandboxing": 11,
    "create": 1,
    "writing": 1,
    "class": 1,
    "largely": 1,
    "password": 1,
    "special": 1,
    "centre": 1,
    "x": 1,
    "victim": 1,
    "premeditate": 1,
    "limit": 1,
    "massage": 1,
    "victimise": 1,
    "complexity": 1,
    "exploit": 9,
    "flow": 1,
    "increasingly": 1,
    "win": 1,
    "fan": 1,
    "desktop": 1,
    "comfort": 1,
    "model": 1,
    "strange": 1,
    "exactly": 1,
    "tiny": 1,
    "order": 3,
    "rein": 1,
    "false": 2,
    "choice": 2,
    "route": 1,
    "find": 4,
    "marketplace": 1,
    "house": 2,
    "end": 4,
    "pointless": 1,
    "lack": 1,
    "ok": 2,
    "solution": 2,
    "perpetration": 1,
    "curated": 2,
    "fact": 3,
    "hide": 1,
    "easy": 1,
    "dangerously": 1,
    "leverage": 1,
    "video": 2,
    "specifically": 1,
    "fine": 1,
    "malicious": 2,
    "luckily": 1,
    "receive": 2,
    "basic": 1,
    "harmless": 1,
    "logical": 1,
    "terrifying": 1,
    "author": 4,
    "popup": 1,
    "ultimate": 1,
    "private": 2,
    "cut": 1,
    "instal": 8,
    "possible": 1,
    "know": 3,
    "permissions/entitlement": 3,
    "system": 5,
    "reasonable": 1,
    "cede": 2,
    "financial": 1,
    "prevent": 1,
    "harden": 1,
    "client": 1,
    "available": 1,
    "particular": 1,
    "ignore": 2,
    "leave": 1,
    "world": 1,
    "carte": 1,
    "examine": 1,
    "blanche": 1,
    "disk": 2,
    "soft": 1,
    "itunes": 2,
    "absolute": 1,
    "weakness": 1,
    ".net": 1,
    "sadly": 1,
    "store": 15,
    "nowadays": 1,
    "manipulate": 1,
    "build": 4,
    "change": 1,
    "policy": 1,
    "restrict": 1,
    "opinion": 1,
    "camera": 2,
    "keylogger": 2,
    "plus": 1,
    "feel": 1,
    "prove": 1,
    "seemingly": 1,
    "suffer": 1,
    "company": 2,
    "laudable": 2,
    "straight": 1,
    "spam": 2,
    "android": 2,
    "apps": 4,
    "measure": 2,
    "individual": 1,
    "work": 3,
    "need": 2,
    "technical": 1,
    "properly": 1,
    "phishing": 1,
    "classic": 1,
    "right": 4,
    "total": 1,
    "confirmation": 1,
    "impose": 3,
    "problem": 10,
    "scam": 1,
    "display": 1,
    "match": 1,
    "page": 1,
    "use": 3,
    "mobile": 2,
    "commonly": 3,
    "ask": 2,
    "hard": 1,
    "download": 7,
    "lull": 1,
    "warm": 1,
    "go": 2,
    "industry": 2,
    "appropriately": 1,
    "allow": 1,
    "ftse": 1,
    "virus": 1,
    "list": 1,
    "wall": 1,
    "actually": 4,
    "give": 2,
    "os": 2,
    "peripheral": 2,
    "get": 2,
    "back": 1,
    "screen": 1,
    "vet": 2,
    "vendor": 2,
    "mode": 1,
    "engineer": 1,
    "user": 10,
    "cutesy": 1,
    "app": 20,
    "criminal": 8,
    "remove": 3,
    "fundamentally": 1,
    "example": 5,
    "beat": 1,
    "normal": 1,
    "guy": 1,
    "guarantee": 2,
    "ios": 1,
    "turn": 1,
    "show": 1,
    "upload": 1,
    "entitlement": 2,
    "facilitate": 1,
    "argument": 1,
    "sinister": 1,
    "payload": 1,
    "hole": 3,
    "computing": 1,
    "attractive": 1,
    "party": 1,
    "push": 2,
    "banking": 1,
    "cover": 1,
    "machine": 4,
    "like": 6,
    "stifle": 2,
    "difficult": 1,
    "essentially": 2,
    "attack": 2,
    "benefit": 1,
    "angle": 1,
    "sense": 3,
    "move": 2,
    "reference": 2,
    "blind": 1,
    "true": 1,
    "play": 1,
    "worm": 1,
    "understand": 1,
    "base": 3,
    "co": 1,
    "control": 6,
    "require": 3,
    "start": 1,
    "transmit": 1,
    "roughly": 1,
    "mark": 1,
    "target": 2,
    "important": 1,
    "particularly": 1,
    "fail": 1,
    "plan": 2,
    "perfect": 1,
    "ipad": 2,
    "server": 4,
    "call": 1,
    "theory": 2,
    "purpose": 2,
    "enlist": 1,
    "try": 1,
    "make": 1,
    "command": 3,
    "secure": 1,
    "way": 5,
    "email": 1,
    "send": 3,
    "execute": 1,
    "developer": 5,
    "privilege": 1,
    "scenario": 1,
    "able": 1,
    "would": 1,
    "directly": 1,
    "platform": 2,
    "fear": 1,
    "difference": 3,
    "opt": 1,
    "device": 5,
    "activex": 1,
    "dare": 1,
    "scale": 1,
    "dramatically": 1,
    "vulnerable": 1,
    "objective": 1,
    "signing": 7,
    "tell": 1,
    "article": 1,
    "cooperation": 2,
    "method": 2,
    "significantly": 1,
    "point": 2,
    "folder": 2,
    "rule": 1,
    "overarching": 1,
    "run": 6,
    "free": 2,
    "mum": 1,
    "flag": 1,
    "operate": 7,
    "view": 1,
    "factory": 1,
    "malware": 27,
    "innovation": 1,
    "defrauds": 1,
    "bandwidth": 1,
    "development": 1,
    "document": 3,
    "player": 1,
    "police": 1,
    "owner": 8,
    "want": 4,
    "define": 1,
    "protection": 1,
    "security": 4,
    "business": 1,
    "morally": 1,
    "windows": 1,
    "application": 12,
    "software": 11,
    "vocal": 1,
    "imply": 3,
    "network": 2,
    "efficacy": 1,
    "similar": 1,
    "experienced": 1,
    "drive": 5,
    "affair": 1,
    "skill": 1,
    "plenty": 1,
    "duly": 1,
    "ne": 5,
    "note": 1,
    "automatically": 3,
    "write": 5,
    "adequately": 1,
    "permission": 10,
    "sharing": 1,
    "blast": 1,
    "load": 1,
    "catch": 1,
    "assume": 1,
    "direction": 1,
    "hoop": 1,
    "occasionally": 1,
    "real": 2,
    "handset": 1,
    "legitimately": 1,
    "constrain": 1,
    "offer": 2,
    "web": 1,
    "broad": 1,
    "reflection": 1,
    "approach": 1,
    "wo": 3,
    "propose": 2,
    "data": 3,
    "confirm": 2,
    "counterpart": 1,
    "bad": 1,
    "open": 2,
    "big": 1,
    "certificate": 1,
    "wish": 2,
    "moment": 1,
    "internet": 3,
    "fancy": 3,
    "entire": 1,
    "watch": 2,
    "gain": 1,
    "rootkit": 2,
    "tear": 1,
    "vast": 1,
    "vector": 7,
    "sign": 3,
    "notionally": 1,
    "market": 1,
    "install": 3,
    "fuzzy": 1,
    "publicly": 1,
    "'ll": 1,
    "talk": 2,
    "impossible": 2,
    "trick": 3,
    "type": 1,
    "direct": 1,
    "grain": 1,
    "personal": 2,
    "thing": 3,
    "issue": 1,
    "reduce": 1,
    "favour": 1,
    "sort": 2,
    "burgle": 1,
    "put": 2,
    "effortlessly": 1,
    "explain": 1,
    "datum": 3,
    "defend": 1,
    "job": 1,
    "botnet": 4,
    "illustration": 1,
    "consider": 2,
    "area": 1,
    "majority": 1,
    "requirement": 2,
    "introduce": 1,
    "distribute": 5
  },
  "title": "Think sandboxing will stop malware? Here's why you're wrong, Apple",
  "core-words": {
    "peripheral": 1,
    "mean": 1,
    "malware": 10,
    "trick": 2,
    "announcement": 1,
    "rein": 1,
    "false": 1,
    "app": 11,
    "owner": 3,
    "attack": 1,
    "stop": 1,
    "example": 2,
    "security": 2,
    "normal": 1,
    "software": 1,
    "exist": 1,
    "build": 3,
    "propose": 1,
    "network": 1,
    "drive": 1,
    "show": 1,
    "popup": 1,
    "similar": 1,
    "dangerously": 1,
    "leverage": 1,
    "ignore": 1,
    "exploit": 1,
    "payload": 1,
    "specifically": 1,
    "craft": 1,
    "malicious": 1,
    "absolutely": 1,
    "ne": 1,
    "execute": 1,
    "automatically": 2,
    "fact": 1,
    "terrifying": 1,
    "developer": 1,
    "author": 2,
    "installation": 1,
    "machine": 1,
    "like": 1,
    "arbitrary": 1,
    "proudly": 1,
    "instal": 2,
    "sandbox": 3,
    "possible": 1,
    "know": 1,
    "people": 1,
    "permissions/entitlement": 1,
    "sense": 1,
    "simply": 3,
    "technique": 1,
    "prevent": 1,
    "true": 1,
    "attractive": 1,
    "particular": 1,
    "vector": 1,
    "explicitly": 2,
    "wrong": 1,
    "carte": 1,
    "usually": 1,
    "activex": 1,
    "way": 1,
    "itunes": 1,
    "video": 1,
    "broad": 1,
    "criminal": 2,
    "application": 3,
    "store": 9,
    "request": 1,
    "imply": 1,
    "acceptable": 1,
    "big": 1,
    "curated": 1,
    "display": 1,
    "use": 1,
    "think": 1,
    "theory": 1,
    "fancy": 1,
    "entire": 1,
    "download": 3,
    "apps": 2,
    "measure": 1,
    "sort": 1,
    "individual": 1,
    "lull": 1,
    "code": 3,
    "user": 2,
    "let": 1,
    "plan": 1,
    "look": 5,
    "phishing": 1,
    "computer": 1,
    "install": 1,
    "right": 1,
    "fireball": 1,
    "wo": 1,
    "total": 1,
    "impose": 2,
    "problem": 1,
    "target": 1,
    "blanche": 1,
    "end": 2,
    "device": 1,
    "sandboxing": 4,
    "spear": 1,
    "free": 1,
    "writing": 1,
    "dare": 1,
    "scale": 1,
    "hard": 1,
    "watch": 2,
    "signing": 2,
    "victimise": 1,
    "botnet": 1,
    "give": 1,
    "go": 2,
    "method": 1,
    "appropriately": 1,
    "company": 1,
    "sign": 1,
    "control": 2,
    "plenty": 1,
    "introduce": 1,
    "permission": 1,
    "run": 1,
    "distribute": 2
  },
  "class": null,
  "tags": [
    "technology/programming",
    "technology/malware",
    "technology/hacking",
    "technology/technology",
    "technology/apple",
    "technology/iphone",
    "technology/microsoft",
    "technology/windows"
  ],
  "content": "At the end of last week, Apple noted that it was moving towards requiring sandboxing for all apps distributed on the Mac App Store. (Sandboxing? We'll explain.) With Windows 8, Metro apps also requiring sandboxing, it looks like industry players seem to think this will in some way control the malware menace. They're wrong. Here's why. Normal software applications, once installed, usually have free rein over the entire computer and its peripherals. Sandboxing looks to control the rights of installed applications so that they don't automatically have carte blanche over the whole machine. A common example is that sandboxed applications typically cannot write to any folder on disk that they fancy. In the mobile world we've typically always had sandboxing. Apple's move with regards to requiring developers to implement sandboxing with the Mac App Store (MAS) and OS X route implies that its engineers feel it's proven such a good idea on the iPhone and iPad that Mac users might as well \"benefit\" as well. The issue that we developers have is that app store owners can arbitrarily define hoops that we have to jump through in order to get our code up there, but that's not the problem. As we'll see, the real menace to computing, both mobile and desktop, has been that it's all but impossible for vendors to remove \"holes\" in system software, or commonly installed apps, that can be exploited. Here's just one - particularly terrifying - example via Daring Fireball that shows how an app-store-acceptable app can be crafted to download and execute an arbitrary payload that gives total control over the device. If you only watch one YouTube video today, watch this one: Sandboxing and the other measures imposed by the app store owners lulls users into a dangerously false sense of security by implying that apps which run in a sandbox are automatically not malicious - which simply is not true. It also dramatically stifles the industry's ability to innovate on the platform. Criminality It's easy to give a type of software a cutesy name, like \"malware\", but what we're actually talking about here is perpetration of premeditated, criminal acts. Malware authors, like all criminals, are in every case looking to exploit a weakness in a system for gain, usually to some innocent party's loss. In the vast majority of cases, people who have the skills to write things such as viruses, worms, rootkits, keyloggers, or botnets choose not to because they operate morally within the rules of reasonable society. When we examine malware, either on a personal computer at your mum's house or on a server in a FTSE 100 business, the criminal's overarching intent is to co-opt the machine for his (occasionally her) own purposes. Those purposes are either to directly steal from you (e.g. a keylogger that steals your online banking password), or to facilitate some other criminal act (e.g. enlisting your computer in a botnet that sends spam, or finds victims and defrauds them). Thus the ultimate objective of the malware criminal is to find a vector that cedes some or all of the control of your computer to them. You can either cede this control by installing software which has hidden functionality, or you can suffer a \"drive-by download\" (more in a moment). Sandboxing, and other measures favoured by app store owners, looks to \"harden\" vectors related to direct installation. But this sort of vector, where the user explicitly commands the machine to install the malware, is a tiny minority of all attacks. Most malware is installed by a drive-by download. In this scenario the software is installed automatically without their cooperation. Even Mac OS X systems have been vulnerable to drive-by downloads. Drive-by downloads are almost always done through exploit vectors in commonly installed client software. Nowadays, most of these are really off-the-wall, such as getting a seemingly harmless PDF file to run some of the malicious code on the user's machine. Vendors of commonly used software \u2013 particularly Microsoft, but also Apple, Adobe and others \u2013 battle daily to remove the holes that can be exploited by malware authors. Unless a malware author is looking to specifically victimise known individuals through spear phishing, he or she will look to build the biggest network possible, and the drive-by download technique is absolutely the way to do it. Tricking the user into explicitly downloading malware through an app store simply doesn't scale for this sort of broad attack. Let's now look at three particular methods that the app store owners are looking to impose on developers that, in theory, make it harder for the owner to end up distributing malware: permissions/entitlements, code signing and sandboxing. Permissions and entitlements Android has had \"permissions\" from the start. The counterpart in OS X and iOS development is called \"entitlements\". On Android and OS X/iOS these work in roughly the same way - you mark the application with \"I want to use the camera\", or \"I need Internet access\", and so on. (We'll ignore Windows Phone, Windows 8 and .NET for now as what they have in this area is too off-beat.) The user has to confirm that the application they wish to run will have these rights over the device, its peripherals and the network. The problem with this permissions model is that it assumes benign intent on the part of the developer. A photo sharing app could ask to use the camera and the internet - basic functionality that it needs in order to operate legitimately. However, you can take those same permissions and, in theory, take photos without permission and upload them to a server of your choice without the user's cooperation. Android gives us an important view into the efficacy of this permissions-based approach. The Android Market is not curated and applications are not vetted before being made publicly available (they are on the Mac App Store or iTunes App Store). What malware-writing criminals can do on the Android Market is build apps that do whatever they fancy and simply request the permissions they need. Luckily for them, the end user either doesn't care or doesn't understand what these permissions mean, and duly opens up the device by blasting straight through the confirmation screens. And you see that in the amount of malware on the Android Market: it's now the worst platform for malware. But the Android Market is a strange case because it's not curated or vetted (although apps can be removed after the fact both from the Market and from handsets at Google's orders.) Notionally there's no difference between putting up a web page and publishing an app on the Android Market. This is why malware is up there in the first place - it's a soft target. Curated app stores, like the Mac App Store, the iTunes App Store, and the proposed Windows 8 app store won't be attractive to malware criminals. There's too much traceability, plus the store owners will be looking at your software, which is something that you really don't want. A common-sense test tells us why - if you were planning a financial scam, the last thing you'd do is write to the FSA documenting your intended methods. My opinion on this is that permissions/entitlements give the store owners a warm fuzzy feeling that they're doing something, but what they're actually doing is essentially nothing. It's the vetting, or lack of it, that makes the difference there. Code signing The point of code signing is laudable: it guarantees that the software code of an application, when we load it, exactly matches what left the factory. It essentially means that nobody can change the application code when it's in the wild. The certificates used for signing also provide some comfort as to where the software came from. For operating system files, this is an absolute requirement. You need a base to work from that you can guarantee has not been exploited or busted open. Signing operating system files - as proposed by the UEFI secure boot mode in Windows 8 - makes rootkits impossible. But that's where it ends. Code signing has been around since the days of ActiveX, and there are plenty of examples of malware targeting ActiveX installation vectors that are \"appropriately\" signed and proudly displays a company name in the IE security popup. (Here's an example.) This, like permissions/entitlements are damaging because it implies security where there is none. There's nothing special or magical about having a signed app. It doesn't affect the malware problem either way. Sandboxing We've already discussed that sandboxing allows for an application's rights to be limited and why asking the user to confirm those rights via permissions is a largely pointless affair. In the MAS requirements we find things like \"an application can only write to its own private folder\" (and not wherever it fancies writing on the disk). OK, laudable - this means that an application distributed via the Mac App Store cannot find my private documents and transmit them back to Malware HQ. Ignoring the fact that malware authors are not going to use curated app stores, sandboxing doesn't prevent you from building a botnet. From first principles, we know that a botnet just needs to be able to receive commands from a \"command and control\" server and then do some work. If we're sending spam, we need to receive a list of email addresses, build each message in turn and then send them to an SMTP server of our choice. Sandboxing doesn't catch any of that. In fact, neither do fine-grained permissions - all we need there is permission to talk to the internet and we're done. So we're back to a false sense of security. \"It must be OK because it will run in a sandbox.\" No, it just means it could be a class of malware that operates adequately within a sandbox. For reference, the video from Charlie Miller referenced at the top of this article exploits a hole in code signing and runs properly with a sandbox. That's the perfect illustration of the problem: malware is about exploits, not about constraining developers. The sinister problem with sandboxing is that it stifles innovation without offering any real malware protection at all. For me, Apple significantly fails with regards to what a user's data actually means. My data is my data, and I shouldn't have to be reduced to tears by the complexity of getting a Word document onto my iPad. If I have data on one device it should flow effortlessly to all of the other devices that I operate. We have the bandwidth and understanding to do this now - it's a trivial problem. My fear with sandboxing is that it pushes this argument in the wrong direction by further restricting data rather than freeing it up. The strength of the personal computer is that you can take data that you own, then massage and manipulate it using any software that you wish to install. That becomes increasingly difficult when the sandbox is in play. We're not winning this battle Apple's move with imposing sandboxing, and Microsoft's moves with its Windows 8 marketplace to do the same, considers the problem of malware from fundamentally the wrong angle. The only reason why malware is distributed through the Android Market is because it is not policed. To distribute malware you either leverage existing exploits, or you trick people to explicitly install applications without using the app stores. (A now classic example, sadly, is operating a call centre and try and trick people into installing or running your code.) Microsoft, the most experienced company at knowing how to defend against malware exploit vectors, does a good job but is nowhere near a \"zero vector\" point. If Microsoft can't do it, there is absolutely no way that Apple or Google can - they simply do not have the experience, no matter how vocal their fan base. On reflection, the policy of the app store owners seems more about covering their own backs than actually offering a solution. You can legislate all you want for code signing, flagging privileges, or sandboxing - it won't make a blind bit of difference. Malware is a criminal problem and a technical solution won't cut it. This is logical if you consider putting better locks on your house - it doesn't stop society creating people who want to burgle you, it just pushes the problem down to the next guy with less good locks."
}